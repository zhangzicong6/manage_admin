(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3af5c226"],{"0bfb":function(t,e,s){"use strict";var i=s("cb7c");t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},3846:function(t,e,s){s("9e1e")&&"g"!=/./g.flags&&s("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:s("0bfb")})},"6b54":function(t,e,s){"use strict";s("3846");var i=s("cb7c"),a=s("0bfb"),n=s("9e1e"),o="toString",r=/./[o],l=function(t){s("2aba")(RegExp.prototype,o,t,!0)};s("79e5")(function(){return"/a/b"!=r.call({source:"a",flags:"b"})})?l(function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?a.call(t):void 0)}):r.name!=o&&l(function(){return r.call(this)})},"94be":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"edit-info"},[s("h2",{staticClass:"title"},[t._v("\n        "+t._s("修改客服消息"==t.$route.name?"修改客服消息":"新建客服消息")+"\n    ")]),s("Form",{staticClass:"form-group",attrs:{model:t.form,"label-position":"right","label-width":100}},[s("FormItem",{attrs:{label:"类型",prop:"type"}},[s("RadioGroup",{attrs:{type:"button"},on:{"on-change":t.changeType},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[s("Radio",{attrs:{label:1}},[t._v("文本")]),s("Radio",{attrs:{label:0}},[t._v("图文")])],1)],1),0==t.type?s("Form",{attrs:{model:t.subForm,"label-position":"right","label-width":100}},[s("FormItem",{attrs:{label:"图片",prop:"picurl"}},[s("Upload",{attrs:{action:"http://test.oorggt.top/reply/upload","show-upload-list":!1,name:"imageFile","on-success":t.handleSuccess}},[s("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("点击上传")]),s("br"),t.imgUrl?s("img",{staticStyle:{"margin-top":"10px"},attrs:{src:t.imgUrl,alt:"",width:"200"}}):t._e()],1)],1),s("FormItem",{attrs:{label:"标题",prop:"title"}},[s("Input",{attrs:{size:"large",type:"text",placeholder:"请输入标题"},model:{value:t.subForm.title,callback:function(e){t.$set(t.subForm,"title",e)},expression:"subForm.title"}})],1),s("FormItem",{attrs:{label:"链接",prop:"url"}},[s("Input",{attrs:{size:"large",type:"text",placeholder:"请输入链接"},model:{value:t.subForm.url,callback:function(e){t.$set(t.subForm,"url",e)},expression:"subForm.url"}})],1),s("FormItem",{attrs:{label:"详细信息",prop:"description"}},[s("Input",{attrs:{size:"large",type:"textarea",placeholder:"请输入详细信息"},model:{value:t.subForm.description,callback:function(e){t.$set(t.subForm,"description",e)},expression:"subForm.description"}})],1),s("FormItem",[s("Button",{staticClass:"edit-btn",attrs:{size:"large",type:"success"},on:{click:t.addOne}},[t._v("添加")]),s("Button",{staticClass:"edit-btn",attrs:{size:"large",type:"primary"},on:{click:t.saveOne}},[t._v("保存")])],1),s("FormItem",{attrs:{label:"图文消息"}},[s("Table",{staticClass:"edit-message-table",attrs:{stripe:"",columns:t.editHeader,data:t.editData}})],1)],1):1==t.type?s("FormItem",{attrs:{label:"详细信息",prop:"description"}},[s("Input",{attrs:{size:"large",type:"textarea",placeholder:"请输入详细信息"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1):t._e(),s("FormItem",{attrs:{label:"人工/延时/定时",prop:"channel"}},[s("RadioGroup",{attrs:{type:"button"},model:{value:t.channel,callback:function(e){t.channel=e},expression:"channel"}},[s("Radio",{attrs:{label:0}},[t._v("人工")]),s("Radio",{attrs:{label:1}},[t._v("延时")]),s("Radio",{attrs:{label:2}},[t._v("定时")])],1)],1),1==t.channel?s("FormItem",{attrs:{label:"延时时间(分钟)",prop:"delay"}},[s("Input",{staticStyle:{width:"180px"},attrs:{size:"large",type:"text",placeholder:"请输入延时时间(分钟)"},model:{value:t.delay,callback:function(e){t.delay=e},expression:"delay"}})],1):t._e(),2==t.channel?s("FormItem",{attrs:{label:"定时时间",prop:"timing_time"}},[s("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.timing_time,callback:function(e){t.timing_time=e},expression:"timing_time"}})],1):t._e(),s("FormItem",{attrs:{label:"类型",prop:"sex"}},[s("RadioGroup",{model:{value:t.sex,callback:function(e){t.sex=e},expression:"sex"}},[s("Radio",{attrs:{label:0}},[t._v("未知")]),s("Radio",{attrs:{label:1}},[t._v("男")]),s("Radio",{attrs:{label:2}},[t._v("女")])],1)],1),s("FormItem",{attrs:{label:"选择标签",prop:"tagName"}},[t.tagName?s("Tag",{attrs:{name:t.tagName,closable:""},on:{"on-close":t.handleClose}},[t._v(t._s(t.tagName))]):t._e()],1),s("FormItem",{attrs:{label:"标签选项"}},t._l(t.tagList,function(e,i){return s("Tag",{attrs:{name:e.name},nativeOn:{click:function(s){t.select(e)}}},[t._v(t._s(e.name))])})),s("FormItem",{attrs:{label:"选择公号",prop:"codes"}},[s("CheckboxGroup",{model:{value:t.codes,callback:function(e){t.codes=e},expression:"codes"}},t._l(t.gonghaoList,function(e,i){return s("Checkbox",{attrs:{label:e.code,name:"codes"}},[t._v(t._s(e.name))])}))],1),s("FormItem",[s("Button",{staticClass:"edit-btn",attrs:{size:"large",type:"success"},on:{click:t.onSave}},[t._v("保存")]),s("Button",{staticClass:"edit-btn",attrs:{size:"large",type:"warning"},on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)},a=[],n=(s("6b54"),s("7f7f"),{data:function(){var t=this;return{form:{},type:1,subForm:{},editData:[],codes:[],contents:[],task:!1,delay:"",description:"",picMessageSwitch:!1,imgUrl:"",gonghaoList:[],obj:{},contentData:{},channel:0,timing_time:new Date,tagName:"",tagList:[],tagId:"",sex:0,editHeader:[{key:"title",title:"标题",align:"center"},{key:"picurl",title:"图片",align:"center",render:function(t,e){return t("img",{attrs:{src:e.row.picurl,style:"width:100%;padding:10px;"}})}},{key:"url",title:"链接",align:"center"},{key:"description",title:"详细信息",align:"description",width:100},{title:"Action",align:"center",render:function(e,s){var i=t;return e("div",[e("Button",{style:{marginRight:"10px"},props:{type:"primary",size:"small"},on:{click:function(){i.subForm=s.row,i.subForm.index=s.index,i.imgUrl=s.row.picurl}}},"修改"),e("Button",{props:{type:"error",size:"small"},on:{click:function(){i.$Modal.confirm({title:"提示:",content:"确认删除这条内容吗？",onOk:function(){"messageUpdate"==i.$route.name&&i.editData.length<=1?i.$Message.info("列表中最少展示一条数据"):(i.editData.splice(s.index,1),i.$Message.info("删除成功"))}})}}},"删除")])}}]}},mounted:function(){this.get_codes(),this.showTagList(),"修改客服消息"==this.$route.name&&(this.obj=this.$route.params,this.editData=this.obj.contents,this.type=this.obj.type,this.description=this.obj.contents[0].description,this.subForm=this.editData[0],this.imgUrl=this.subForm.picurl,this.delay=this.obj.delay,this.channel=this.obj.is_timing?2:this.obj.task?1:0,this.timing_time=this.obj.timing_time,this.tagId=this.obj.tagId,this.codes=this.obj.codes,this.sex=parseInt(this.obj.sex),this.tagId&&this.showList())},methods:{handleClose:function(){this.tagName=""},showTagList:function(){var t=this;this.$axios.get("/tag").then(function(e){t.tagList=e.data.data})},select:function(t){this.tagId=t._id,this.tagName=t.name},onSave:function(){var t=this;1==this.type?(this.contentData.description=this.description,this.contents.push(this.contentData)):this.contents=this.editData,"添加客服消息"==this.$route.name?this.$axios.post("/message/create",{contents:this.contents,type:this.type,task:"1"==this.channel,is_timing:"2"==this.channel,delay:this.delay,timing_time:""==this.timing_time?"":this.timing_time,codes:this.codes,img:this.contents[0].picurl,tagId:this.tagId,sex:this.sex.toString()}).then(function(e){e.data.success?(t.reset(),t.$router.push({name:"消息管理"}),t.$Message.info(e.data.success)):t.$Message.info(e.data.err)}):"修改客服消息"==this.$route.name&&this.$axios.post("/message/update",{id:this.obj._id,contents:this.contents,type:this.type,task:"1"==this.channel,is_timing:"2"==this.channel,delay:this.delay,timing_time:""==this.timing_time?"":this.timing_time,codes:this.codes,img:this.contents[0].picurl,tagId:""==this.tagName?"":this.tagId,sex:this.sex.toString()}).then(function(e){e.data.success?(t.reset(),t.$router.push({name:"消息管理"}),t.$Message.info(e.data.success)):t.$Message.info(e.data.err)})},addOne:function(){this.subForm.picurl=this.imgUrl,this.editData.push(this.subForm),this.subForm={},this.imgUrl=""},saveOne:function(){this.editData.splice(this.subForm.index,1,this.subForm),this.subForm={},this.imgUrl=""},changeType:function(){this.reset()},handleSuccess:function(t,e){this.imgUrl="http://test.oorggt.top/uploads/"+t.filename},showList:function(){var t=this;this.$axios.get("/tag/get_name",{params:{tagId:this.tagId}}).then(function(e){t.tagName=e.data.data.name})},reset:function(){this.form={},this.subForm={},this.imgUrl="",this.editData=[]},cancel:function(){this.reset(),this.$router.push({name:"消息管理"})},get_codes:function(){var t=this;this.$axios.get("/message/get_code").then(function(e){0!=e.data.data.length&&(t.gonghaoList=e.data.data)})}}}),o=n,r=(s("ba69"),s("2877")),l=Object(r["a"])(o,i,a,!1,null,"218e1c48",null);l.options.__file="editInfo.vue";e["default"]=l.exports},ba69:function(t,e,s){"use strict";var i=s("e7a5"),a=s.n(i);a.a},e7a5:function(t,e,s){}}]);
//# sourceMappingURL=chunk-3af5c226.aff77fac.js.map